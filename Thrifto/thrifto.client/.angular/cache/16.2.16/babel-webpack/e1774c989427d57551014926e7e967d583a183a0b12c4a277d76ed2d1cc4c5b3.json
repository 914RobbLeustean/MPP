{"ast":null,"code":"import { ConnectionStatus } from './services/network.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/signalr.service\";\nimport * as i2 from \"./services/network.service\";\nimport * as i3 from \"./services/offline-queue.service\";\nimport * as i4 from \"./services/auth.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"./components/shared/network-status/network-status.component\";\nimport * as i7 from \"./components/shared/header/header.component\";\nimport * as i8 from \"./components/shared/footer/footer.component\";\nexport class AppComponent {\n  constructor(signalrService, networkService, offlineQueueService, authService) {\n    this.signalrService = signalrService;\n    this.networkService = networkService;\n    this.offlineQueueService = offlineQueueService;\n    this.authService = authService;\n    this.title = 'Thrifto';\n  }\n  ngOnInit() {\n    // Initialize network monitoring\n    this.networkService.status$.subscribe(status => {\n      console.log('Network status:', status);\n      // Manage SignalR connection based on network status\n      if (status === ConnectionStatus.Online && this.authService.isLoggedIn()) {\n        this.initializeSignalRConnection();\n      } else {\n        // Disconnect SignalR if network is down or server is down\n        this.signalrService.stopConnection();\n      }\n    });\n    // Setup window focus event to check connection when tab becomes active\n    window.addEventListener('focus', () => {\n      this.networkService.checkConnection();\n    });\n    // Listen for auth state changes to manage SignalR connection\n    this.authService.currentUser$.subscribe(user => {\n      if (user && this.networkService.isOnline) {\n        this.initializeSignalRConnection();\n      } else if (!user) {\n        this.signalrService.stopConnection();\n      }\n    });\n    // Initial connection if conditions are right\n    if (this.networkService.isOnline && this.authService.isLoggedIn()) {\n      this.initializeSignalRConnection();\n    }\n  }\n  initializeSignalRConnection() {\n    this.signalrService.startConnection().then(() => console.log('SignalR connected successfully')).catch(err => console.error('Error connecting to SignalR:', err));\n  }\n  static {\n    this.ɵfac = function AppComponent_Factory(t) {\n      return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.SignalrService), i0.ɵɵdirectiveInject(i2.NetworkService), i0.ɵɵdirectiveInject(i3.OfflineQueueService), i0.ɵɵdirectiveInject(i4.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AppComponent,\n      selectors: [[\"app-root\"]],\n      decls: 5,\n      vars: 0,\n      consts: [[1, \"main-content\"]],\n      template: function AppComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelement(0, \"app-header\");\n          i0.ɵɵelementStart(1, \"main\", 0);\n          i0.ɵɵelement(2, \"router-outlet\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(3, \"app-network-status\")(4, \"app-footer\");\n        }\n      },\n      dependencies: [i5.RouterOutlet, i6.NetworkStatusComponent, i7.HeaderComponent, i8.FooterComponent],\n      styles: [\"\\n\\n[_nghost-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  min-height: 100vh;\\n  position: relative;\\n  overflow-x: hidden;\\n}\\n\\nmain[_ngcontent-%COMP%] {\\n  min-height: calc(100vh - 60px - 200px);\\n  position: relative;\\n}\\n\\napp-footer[_ngcontent-%COMP%] {\\n  flex-shrink: 0;\\n  position: relative;\\n  z-index: 0;\\n  width: 100%;\\n  background-color: #1e293b;\\n  margin-bottom: -1px; \\n\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvYXBwLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLCtCQUFBO0FBQ0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxpQkFBQTtFQUNBLGtCQUFBO0VBQ0Esa0JBQUE7QUFDRjs7QUFFQTtFQUNFLHNDQUFBO0VBRUEsa0JBQUE7QUFBRjs7QUFHQTtFQUNFLGNBQUE7RUFDQSxrQkFBQTtFQUNBLFVBQUE7RUFDQSxXQUFBO0VBQ0EseUJBQUE7RUFDQSxtQkFBQSxFQUFBLDJDQUFBO0FBQUYiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBzcmMvYXBwL2FwcC5jb21wb25lbnQuc2NzcyAqL1xyXG46aG9zdCB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIG1pbi1oZWlnaHQ6IDEwMHZoO1xyXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICBvdmVyZmxvdy14OiBoaWRkZW47XHJcbn1cclxuXHJcbm1haW4ge1xyXG4gIG1pbi1oZWlnaHQ6IGNhbGMoMTAwdmggLSA2MHB4IC0gMjAwcHgpO1xyXG4gIC8vIEFkanVzdCBiYXNlZCBvbiBoZWFkZXIgYW5kIGZvb3RlciBoZWlnaHRzXHJcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG59XHJcblxyXG5hcHAtZm9vdGVyIHtcclxuICBmbGV4LXNocmluazogMDtcclxuICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgei1pbmRleDogMDtcclxuICB3aWR0aDogMTAwJTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMWUyOTNiO1xyXG4gIG1hcmdpbi1ib3R0b206IC0xcHg7IC8qIFRoaXMgaGVscHMgZWxpbWluYXRlIGFueSBwb3RlbnRpYWwgZ2FwICovXHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["ConnectionStatus","AppComponent","constructor","signalrService","networkService","offlineQueueService","authService","title","ngOnInit","status$","subscribe","status","console","log","Online","isLoggedIn","initializeSignalRConnection","stopConnection","window","addEventListener","checkConnection","currentUser$","user","isOnline","startConnection","then","catch","err","error","i0","ɵɵdirectiveInject","i1","SignalrService","i2","NetworkService","i3","OfflineQueueService","i4","AuthService","selectors","decls","vars","consts","template","AppComponent_Template","rf","ctx","ɵɵelement","ɵɵelementStart","ɵɵelementEnd"],"sources":["C:\\Users\\leust\\source\\repos\\MPP-main\\Thrifto\\thrifto.client\\src\\app\\app.component.ts","C:\\Users\\leust\\source\\repos\\MPP-main\\Thrifto\\thrifto.client\\src\\app\\app.component.html"],"sourcesContent":["// src/app/app.component.ts\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { NetworkService, ConnectionStatus } from './services/network.service';\r\nimport { OfflineQueueService } from './services/offline-queue.service';\r\nimport { SignalrService } from './services/signalr.service';\r\nimport { AuthService } from './services/auth.service';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent implements OnInit {\r\n  title = 'Thrifto';\r\n\r\n  constructor(\r\n    private signalrService: SignalrService,\r\n    private networkService: NetworkService,\r\n    private offlineQueueService: OfflineQueueService,\r\n    private authService: AuthService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    // Initialize network monitoring\r\n    this.networkService.status$.subscribe(status => {\r\n      console.log('Network status:', status);\r\n\r\n      // Manage SignalR connection based on network status\r\n      if (status === ConnectionStatus.Online && this.authService.isLoggedIn()) {\r\n        this.initializeSignalRConnection();\r\n      } else {\r\n        // Disconnect SignalR if network is down or server is down\r\n        this.signalrService.stopConnection();\r\n      }\r\n    });\r\n\r\n    // Setup window focus event to check connection when tab becomes active\r\n    window.addEventListener('focus', () => {\r\n      this.networkService.checkConnection();\r\n    });\r\n\r\n    // Listen for auth state changes to manage SignalR connection\r\n    this.authService.currentUser$.subscribe(user => {\r\n      if (user && this.networkService.isOnline) {\r\n        this.initializeSignalRConnection();\r\n      } else if (!user) {\r\n        this.signalrService.stopConnection();\r\n      }\r\n    });\r\n\r\n    // Initial connection if conditions are right\r\n    if (this.networkService.isOnline && this.authService.isLoggedIn()) {\r\n      this.initializeSignalRConnection();\r\n    }\r\n  }\r\n\r\n  private initializeSignalRConnection(): void {\r\n    this.signalrService.startConnection()\r\n      .then(() => console.log('SignalR connected successfully'))\r\n      .catch(err => console.error('Error connecting to SignalR:', err));\r\n  }\r\n}\r\n","<!-- src/app/app.component.html -->\r\n<app-header></app-header>\r\n\r\n<main class=\"main-content\">\r\n  <router-outlet></router-outlet>\r\n</main>\r\n\r\n<app-network-status></app-network-status>\r\n\r\n<app-footer></app-footer>\r\n"],"mappings":"AAEA,SAAyBA,gBAAgB,QAAQ,4BAA4B;;;;;;;;;;AAU7E,OAAM,MAAOC,YAAY;EAGvBC,YACUC,cAA8B,EAC9BC,cAA8B,EAC9BC,mBAAwC,EACxCC,WAAwB;IAHxB,KAAAH,cAAc,GAAdA,cAAc;IACd,KAAAC,cAAc,GAAdA,cAAc;IACd,KAAAC,mBAAmB,GAAnBA,mBAAmB;IACnB,KAAAC,WAAW,GAAXA,WAAW;IANrB,KAAAC,KAAK,GAAG,SAAS;EAOb;EAEJC,QAAQA,CAAA;IACN;IACA,IAAI,CAACJ,cAAc,CAACK,OAAO,CAACC,SAAS,CAACC,MAAM,IAAG;MAC7CC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEF,MAAM,CAAC;MAEtC;MACA,IAAIA,MAAM,KAAKX,gBAAgB,CAACc,MAAM,IAAI,IAAI,CAACR,WAAW,CAACS,UAAU,EAAE,EAAE;QACvE,IAAI,CAACC,2BAA2B,EAAE;OACnC,MAAM;QACL;QACA,IAAI,CAACb,cAAc,CAACc,cAAc,EAAE;;IAExC,CAAC,CAAC;IAEF;IACAC,MAAM,CAACC,gBAAgB,CAAC,OAAO,EAAE,MAAK;MACpC,IAAI,CAACf,cAAc,CAACgB,eAAe,EAAE;IACvC,CAAC,CAAC;IAEF;IACA,IAAI,CAACd,WAAW,CAACe,YAAY,CAACX,SAAS,CAACY,IAAI,IAAG;MAC7C,IAAIA,IAAI,IAAI,IAAI,CAAClB,cAAc,CAACmB,QAAQ,EAAE;QACxC,IAAI,CAACP,2BAA2B,EAAE;OACnC,MAAM,IAAI,CAACM,IAAI,EAAE;QAChB,IAAI,CAACnB,cAAc,CAACc,cAAc,EAAE;;IAExC,CAAC,CAAC;IAEF;IACA,IAAI,IAAI,CAACb,cAAc,CAACmB,QAAQ,IAAI,IAAI,CAACjB,WAAW,CAACS,UAAU,EAAE,EAAE;MACjE,IAAI,CAACC,2BAA2B,EAAE;;EAEtC;EAEQA,2BAA2BA,CAAA;IACjC,IAAI,CAACb,cAAc,CAACqB,eAAe,EAAE,CAClCC,IAAI,CAAC,MAAMb,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC,CAAC,CACzDa,KAAK,CAACC,GAAG,IAAIf,OAAO,CAACgB,KAAK,CAAC,8BAA8B,EAAED,GAAG,CAAC,CAAC;EACrE;;;uBAhDW1B,YAAY,EAAA4B,EAAA,CAAAC,iBAAA,CAAAC,EAAA,CAAAC,cAAA,GAAAH,EAAA,CAAAC,iBAAA,CAAAG,EAAA,CAAAC,cAAA,GAAAL,EAAA,CAAAC,iBAAA,CAAAK,EAAA,CAAAC,mBAAA,GAAAP,EAAA,CAAAC,iBAAA,CAAAO,EAAA,CAAAC,WAAA;IAAA;EAAA;;;YAAZrC,YAAY;MAAAsC,SAAA;MAAAC,KAAA;MAAAC,IAAA;MAAAC,MAAA;MAAAC,QAAA,WAAAC,sBAAAC,EAAA,EAAAC,GAAA;QAAA,IAAAD,EAAA;UCXzBhB,EAAA,CAAAkB,SAAA,iBAAyB;UAEzBlB,EAAA,CAAAmB,cAAA,cAA2B;UACzBnB,EAAA,CAAAkB,SAAA,oBAA+B;UACjClB,EAAA,CAAAoB,YAAA,EAAO;UAEPpB,EAAA,CAAAkB,SAAA,yBAAyC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}