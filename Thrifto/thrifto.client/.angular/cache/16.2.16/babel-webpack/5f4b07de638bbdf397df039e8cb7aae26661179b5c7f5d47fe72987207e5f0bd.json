{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../services/listing.service\";\nimport * as i4 from \"../../services/auth.service\";\nimport * as i5 from \"../../services/notification.service\";\nimport * as i6 from \"@angular/common\";\nfunction EditListingComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtext(1, \" UPDATED SUCCESSFULLY \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditListingComponent_div_5_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r5.errorMessage);\n  }\n}\nfunction EditListingComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \" UPDATE FAILED \");\n    i0.ɵɵtemplate(2, EditListingComponent_div_5_div_2_Template, 2, 1, \"div\", 9);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.errorMessage);\n  }\n}\nfunction EditListingComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 11);\n  }\n}\nfunction EditListingComponent_div_7_div_6_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 47);\n  }\n  if (rf & 2) {\n    const photo_r12 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", photo_r12, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction EditListingComponent_div_7_div_6_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 48);\n    i0.ɵɵlistener(\"click\", function EditListingComponent_div_7_div_6_div_2_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const i_r13 = i0.ɵɵnextContext().index;\n      const ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.triggerFileInput(i_r13));\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(1, \"svg\", 49);\n    i0.ɵɵelement(2, \"path\", 50)(3, \"polyline\", 51)(4, \"line\", 52)(5, \"line\", 53);\n    i0.ɵɵelementEnd();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"span\");\n    i0.ɵɵtext(7, \"Add Photo\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction EditListingComponent_div_7_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 44);\n    i0.ɵɵtemplate(1, EditListingComponent_div_7_div_6_img_1_Template, 1, 1, \"img\", 45);\n    i0.ɵɵtemplate(2, EditListingComponent_div_7_div_6_div_2_Template, 8, 0, \"div\", 46);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const photo_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", photo_r12);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !photo_r12);\n  }\n}\nfunction EditListingComponent_div_7_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 54);\n    i0.ɵɵtext(1, \" Title is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditListingComponent_div_7_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 54);\n    i0.ɵɵtext(1, \" Measurement is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditListingComponent_div_7_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 55);\n    i0.ɵɵtext(1, \" Description is too long (maximum 250 characters). \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditListingComponent_div_7_div_42_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Price is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditListingComponent_div_7_div_42_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Price must be greater than 0\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditListingComponent_div_7_div_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 54);\n    i0.ɵɵtemplate(1, EditListingComponent_div_7_div_42_div_1_Template, 2, 0, \"div\", 56);\n    i0.ɵɵtemplate(2, EditListingComponent_div_7_div_42_div_2_Template, 2, 0, \"div\", 56);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    let tmp_0_0;\n    let tmp_1_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (tmp_0_0 = ctx_r10.listingForm.get(\"price\")) == null ? null : tmp_0_0.errors == null ? null : tmp_0_0.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (tmp_1_0 = ctx_r10.listingForm.get(\"price\")) == null ? null : tmp_1_0.errors == null ? null : tmp_1_0.errors[\"min\"]);\n  }\n}\nfunction EditListingComponent_div_7_span_51_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 57);\n  }\n}\nfunction EditListingComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"div\", 14)(3, \"h3\");\n    i0.ɵɵtext(4, \"Photos\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 15);\n    i0.ɵɵtemplate(6, EditListingComponent_div_7_div_6_Template, 3, 2, \"div\", 16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 17)(8, \"form\", 18);\n    i0.ɵɵlistener(\"ngSubmit\", function EditListingComponent_div_7_Template_form_ngSubmit_8_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.onSubmit());\n    });\n    i0.ɵɵelementStart(9, \"div\", 19)(10, \"label\", 20);\n    i0.ɵɵtext(11, \"Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"input\", 21);\n    i0.ɵɵtemplate(13, EditListingComponent_div_7_div_13_Template, 2, 0, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 19)(15, \"label\", 23);\n    i0.ɵɵtext(16, \"Measurement\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(17, \"input\", 24);\n    i0.ɵɵtemplate(18, EditListingComponent_div_7_div_18_Template, 2, 0, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\", 19)(20, \"label\", 25);\n    i0.ɵɵtext(21, \"Quality\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"select\", 26)(23, \"option\", 27);\n    i0.ɵɵtext(24, \"NEW\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"option\", 28);\n    i0.ɵɵtext(26, \"LIKE NEW\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"option\", 29);\n    i0.ɵɵtext(28, \"BARELY WORN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"option\", 30);\n    i0.ɵɵtext(30, \"USED\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(31, \"div\", 19)(32, \"label\", 31);\n    i0.ɵɵtext(33, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(34, \"textarea\", 32);\n    i0.ɵɵelementStart(35, \"div\", 33);\n    i0.ɵɵtext(36);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(37, EditListingComponent_div_7_div_37_Template, 2, 0, \"div\", 34);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"div\", 19)(39, \"label\", 35);\n    i0.ɵɵtext(40, \"Price ($)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(41, \"input\", 36);\n    i0.ɵɵtemplate(42, EditListingComponent_div_7_div_42_Template, 3, 2, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(43, \"div\", 37)(44, \"label\", 38);\n    i0.ɵɵelement(45, \"input\", 39);\n    i0.ɵɵtext(46, \" Replace all existing photos \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"div\", 40)(48, \"button\", 41);\n    i0.ɵɵlistener(\"click\", function EditListingComponent_div_7_Template_button_click_48_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.cancel());\n    });\n    i0.ɵɵtext(49, \" Cancel \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(50, \"button\", 42);\n    i0.ɵɵtemplate(51, EditListingComponent_div_7_span_51_Template, 1, 0, \"span\", 43);\n    i0.ɵɵtext(52, \" Update Listing \");\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    let tmp_2_0;\n    let tmp_3_0;\n    let tmp_4_0;\n    let tmp_5_0;\n    let tmp_6_0;\n    let tmp_7_0;\n    let tmp_8_0;\n    let tmp_9_0;\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.photos);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.listingForm);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", ((tmp_2_0 = ctx_r3.listingForm.get(\"title\")) == null ? null : tmp_2_0.invalid) && ((tmp_2_0 = ctx_r3.listingForm.get(\"title\")) == null ? null : tmp_2_0.touched));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = ctx_r3.listingForm.get(\"title\")) == null ? null : tmp_3_0.invalid) && ((tmp_3_0 = ctx_r3.listingForm.get(\"title\")) == null ? null : tmp_3_0.touched));\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", ((tmp_4_0 = ctx_r3.listingForm.get(\"measurement\")) == null ? null : tmp_4_0.invalid) && ((tmp_4_0 = ctx_r3.listingForm.get(\"measurement\")) == null ? null : tmp_4_0.touched));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = ctx_r3.listingForm.get(\"measurement\")) == null ? null : tmp_5_0.invalid) && ((tmp_5_0 = ctx_r3.listingForm.get(\"measurement\")) == null ? null : tmp_5_0.touched));\n    i0.ɵɵadvance(18);\n    i0.ɵɵtextInterpolate1(\" \", ((tmp_6_0 = ctx_r3.listingForm.get(\"description\")) == null ? null : tmp_6_0.value == null ? null : tmp_6_0.value.length) || 0, \"/250 characters \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_7_0 = ctx_r3.listingForm.get(\"description\")) == null ? null : tmp_7_0.invalid) && ((tmp_7_0 = ctx_r3.listingForm.get(\"description\")) == null ? null : tmp_7_0.touched));\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", ((tmp_8_0 = ctx_r3.listingForm.get(\"price\")) == null ? null : tmp_8_0.invalid) && ((tmp_8_0 = ctx_r3.listingForm.get(\"price\")) == null ? null : tmp_8_0.touched));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_9_0 = ctx_r3.listingForm.get(\"price\")) == null ? null : tmp_9_0.invalid) && ((tmp_9_0 = ctx_r3.listingForm.get(\"price\")) == null ? null : tmp_9_0.touched));\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.listingForm.invalid || ctx_r3.isSubmitting);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.isSubmitting);\n  }\n}\nfunction EditListingComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 58)(1, \"h2\");\n    i0.ɵɵtext(2, \"Listing Not Found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4, \"The listing you're trying to edit does not exist or has been removed.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"a\", 59);\n    i0.ɵɵtext(6, \"Go Back to Sell Page\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class EditListingComponent {\n  constructor(fb, route, router, listingService, authService, notificationService) {\n    this.fb = fb;\n    this.route = route;\n    this.router = router;\n    this.listingService = listingService;\n    this.authService = authService;\n    this.notificationService = notificationService;\n    this.listing = null;\n    this.photos = [null, null, null, null]; // Four photo placeholders\n    this.photoFiles = [null, null, null, null]; // Store the actual file objects\n    this.showSuccessNotification = false;\n    this.showFailedNotification = false;\n    this.isSubmitting = false;\n    this.isLoading = true;\n    this.errorMessage = '';\n    // Initialize the form here\n    this.initForm();\n  }\n  // Initialize form separately to avoid null issues\n  initForm() {\n    this.listingForm = this.fb.group({\n      title: ['', Validators.required],\n      measurement: ['', Validators.required],\n      quality: ['NEW', Validators.required],\n      price: ['', [Validators.required, Validators.min(0.01)]],\n      description: ['', [Validators.maxLength(250)]],\n      deleteExistingPhotos: [false]\n    });\n  }\n  ngOnInit() {\n    this.route.params.subscribe(params => {\n      this.listingId = +params['id'];\n      if (!isNaN(this.listingId)) {\n        this.loadListing();\n      } else {\n        this.router.navigate(['/sell']);\n      }\n    });\n  }\n  loadListing() {\n    this.isLoading = true;\n    this.listingService.getListingById(this.listingId).subscribe({\n      next: listing => {\n        this.listing = listing;\n        console.log('Loaded listing for editing:', listing);\n        // Check if the current user is the owner\n        if (listing.userId !== this.authService.getCurrentUserId()) {\n          this.notificationService.show('You do not have permission to edit this listing', 'error');\n          this.router.navigate(['/sell']);\n          return;\n        }\n        // Populate the form with safer null checks\n        this.listingForm.patchValue({\n          title: listing.title || '',\n          measurement: listing.measurement || '',\n          quality: listing.quality || 'NEW',\n          price: listing.price || '',\n          description: listing.description || '' // Make sure description is initialized\n        });\n\n        console.log('Form values after patch:', this.listingForm.value);\n        // Populate photo previews\n        if (listing.photoUrls?.length) {\n          listing.photoUrls.forEach((url, index) => {\n            if (index < 4) {\n              this.photos[index] = this.getImageUrl(url);\n            }\n          });\n        }\n        this.isLoading = false;\n      },\n      error: error => {\n        console.error('Error loading listing', error);\n        this.notificationService.show('Error loading listing details', 'error');\n        this.isLoading = false;\n        this.router.navigate(['/sell']);\n      }\n    });\n  }\n  getImageUrl(url) {\n    if (!url) {\n      return 'assets/images/placeholder.png';\n    }\n    // If the URL is relative (from your backend)\n    if (url.startsWith('/')) {\n      const baseUrl = environment.apiUrl.split('/api')[0];\n      return `${baseUrl}${url}`;\n    }\n    return url;\n  }\n  triggerFileInput(index) {\n    const fileInput = document.createElement('input');\n    fileInput.type = 'file';\n    fileInput.accept = 'image/*';\n    fileInput.onchange = event => {\n      this.onFileSelected(event, index);\n    };\n    fileInput.click();\n  }\n  onFileSelected(event, index) {\n    const file = event.target.files[0];\n    if (file) {\n      this.photoFiles[index] = file;\n      const reader = new FileReader();\n      reader.onload = e => {\n        this.photos[index] = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    }\n  }\n  onSubmit() {\n    if (this.listingForm.valid) {\n      this.isSubmitting = true;\n      this.errorMessage = '';\n      try {\n        const formData = new FormData();\n        // Get all form values from the form\n        const formValues = this.listingForm.value;\n        console.log('Original form values:', formValues);\n        // Append form values - using lowercase to match model binding\n        formData.append('title', formValues.title || '');\n        formData.append('measurement', formValues.measurement || '');\n        formData.append('quality', formValues.quality || '');\n        formData.append('price', (formValues.price || 0).toString());\n        // Handle description field - ensure it's never null\n        const description = formValues.description !== null && formValues.description !== undefined ? formValues.description : '';\n        formData.append('description', description);\n        // Handle delete existing photos flag\n        formData.append('deleteExistingPhotos', formValues.deleteExistingPhotos ? 'true' : 'false');\n        // Add new photos if any\n        let hasNewPhotos = false;\n        this.photoFiles.forEach(file => {\n          if (file) {\n            formData.append('photos', file);\n            hasNewPhotos = true;\n          }\n        });\n        // Debug the form data\n        console.log('Submitting update with new photos:', hasNewPhotos);\n        this.listingService.updateListing(this.listingId, formData).subscribe({\n          next: response => {\n            this.isSubmitting = false;\n            this.showSuccessNotification = true;\n            this.notificationService.show('Listing updated successfully!', 'success');\n            setTimeout(() => {\n              this.showSuccessNotification = false;\n              this.router.navigate(['/listing', this.listingId]);\n            }, 2000);\n          },\n          error: error => {\n            this.isSubmitting = false;\n            this.showFailedNotification = true;\n            // Attempt to extract a more detailed error message\n            if (error.error) {\n              if (typeof error.error === 'string') {\n                this.errorMessage = error.error;\n              } else if (error.error.errors) {\n                this.errorMessage = 'Validation errors: ';\n                for (const key in error.error.errors) {\n                  if (error.error.errors.hasOwnProperty(key)) {\n                    this.errorMessage += `${key}: ${error.error.errors[key].join(', ')}; `;\n                  }\n                }\n              } else if (error.error.message) {\n                this.errorMessage = error.error.message;\n              }\n            }\n            console.error('Error updating listing', error);\n            this.notificationService.show(`Error updating listing: ${this.errorMessage || 'Unknown error'}`, 'error');\n            setTimeout(() => this.showFailedNotification = false, 3000);\n          }\n        });\n      } catch (err) {\n        this.isSubmitting = false;\n        this.showFailedNotification = true;\n        console.error('Exception while preparing form data:', err);\n        this.notificationService.show('Error preparing form data', 'error');\n        setTimeout(() => this.showFailedNotification = false, 3000);\n      }\n    } else {\n      // Form is invalid - highlight the errors\n      Object.keys(this.listingForm.controls).forEach(key => {\n        const control = this.listingForm.get(key);\n        if (control?.invalid) {\n          control.markAsTouched();\n        }\n      });\n      this.notificationService.show('Please fix the form errors before submitting', 'error');\n    }\n  }\n  cancel() {\n    this.router.navigate(['/listing', this.listingId]);\n  }\n  static {\n    this.ɵfac = function EditListingComponent_Factory(t) {\n      return new (t || EditListingComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ListingService), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i5.NotificationService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EditListingComponent,\n      selectors: [[\"app-edit-listing\"]],\n      decls: 9,\n      vars: 5,\n      consts: [[1, \"container\"], [1, \"notifications\"], [\"class\", \"notification success\", 4, \"ngIf\"], [\"class\", \"notification error\", 4, \"ngIf\"], [\"class\", \"loading-spinner\", 4, \"ngIf\"], [\"class\", \"edit-form-container\", 4, \"ngIf\"], [\"class\", \"not-found\", 4, \"ngIf\"], [1, \"notification\", \"success\"], [1, \"notification\", \"error\"], [\"class\", \"error-details\", 4, \"ngIf\"], [1, \"error-details\"], [1, \"loading-spinner\"], [1, \"edit-form-container\"], [1, \"listing-form\"], [1, \"photos-container\"], [1, \"photo-grid\"], [\"class\", \"photo-upload\", 4, \"ngFor\", \"ngForOf\"], [1, \"form-details\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"title\"], [\"type\", \"text\", \"id\", \"title\", \"formControlName\", \"title\", \"placeholder\", \"e.g., Women's Jeans\", 1, \"form-control\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"for\", \"measurement\"], [\"type\", \"text\", \"id\", \"measurement\", \"formControlName\", \"measurement\", \"placeholder\", \"e.g., W 32UK\", 1, \"form-control\"], [\"for\", \"quality\"], [\"id\", \"quality\", \"formControlName\", \"quality\", 1, \"form-control\"], [\"value\", \"NEW\"], [\"value\", \"LIKE NEW\"], [\"value\", \"BARELY WORN\"], [\"value\", \"USED\"], [\"for\", \"description\"], [\"id\", \"description\", \"formControlName\", \"description\", \"rows\", \"4\", \"maxlength\", \"250\", \"placeholder\", \"Describe your item (optional)\", 1, \"form-control\"], [1, \"character-counter\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"for\", \"price\"], [\"type\", \"number\", \"id\", \"price\", \"formControlName\", \"price\", \"placeholder\", \"e.g., 27\", \"step\", \"0.01\", \"min\", \"0.01\", 1, \"form-control\"], [1, \"photo-options\"], [1, \"checkbox-label\"], [\"type\", \"checkbox\", \"formControlName\", \"deleteExistingPhotos\"], [1, \"form-actions\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"class\", \"spinner-border spinner-border-sm\", 4, \"ngIf\"], [1, \"photo-upload\"], [\"alt\", \"Product photo\", 3, \"src\", 4, \"ngIf\"], [\"class\", \"upload-placeholder\", 3, \"click\", 4, \"ngIf\"], [\"alt\", \"Product photo\", 3, \"src\"], [1, \"upload-placeholder\", 3, \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"24\", \"height\", \"24\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"d\", \"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"], [\"points\", \"14 2 14 8 20 8\"], [\"x1\", \"12\", \"y1\", \"18\", \"x2\", \"12\", \"y2\", \"12\"], [\"x1\", \"9\", \"y1\", \"15\", \"x2\", \"15\", \"y2\", \"15\"], [1, \"invalid-feedback\"], [1, \"error-message\"], [4, \"ngIf\"], [1, \"spinner-border\", \"spinner-border-sm\"], [1, \"not-found\"], [\"routerLink\", \"/sell\", 1, \"btn\", \"btn-primary\"]],\n      template: function EditListingComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n          i0.ɵɵtext(2, \"Edit Listing\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\", 1);\n          i0.ɵɵtemplate(4, EditListingComponent_div_4_Template, 2, 0, \"div\", 2);\n          i0.ɵɵtemplate(5, EditListingComponent_div_5_Template, 3, 1, \"div\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(6, EditListingComponent_div_6_Template, 1, 0, \"div\", 4);\n          i0.ɵɵtemplate(7, EditListingComponent_div_7_Template, 53, 15, \"div\", 5);\n          i0.ɵɵtemplate(8, EditListingComponent_div_8_Template, 7, 0, \"div\", 6);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngIf\", ctx.showSuccessNotification);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.showFailedNotification);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && ctx.listing);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && !ctx.listing);\n        }\n      },\n      dependencies: [i6.NgForOf, i6.NgIf, i2.RouterLink, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.CheckboxControlValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.MaxLengthValidator, i1.MinValidator, i1.FormGroupDirective, i1.FormControlName],\n      styles: [\"\\n\\n.container[_ngcontent-%COMP%] {\\n  max-width: 1000px;\\n  margin: 0 auto;\\n  padding: 40px 20px;\\n}\\n\\nh1[_ngcontent-%COMP%] {\\n  font-size: 28px;\\n  margin-bottom: 30px;\\n  color: #333;\\n}\\n\\n.notifications[_ngcontent-%COMP%] {\\n  margin-bottom: 20px;\\n}\\n.notifications[_ngcontent-%COMP%]   .notification[_ngcontent-%COMP%] {\\n  padding: 12px 16px;\\n  margin-bottom: 10px;\\n  border-radius: 4px;\\n  text-align: center;\\n  font-weight: 500;\\n}\\n.notifications[_ngcontent-%COMP%]   .notification.success[_ngcontent-%COMP%] {\\n  background-color: #4caf50;\\n  color: white;\\n}\\n.notifications[_ngcontent-%COMP%]   .notification.error[_ngcontent-%COMP%] {\\n  background-color: #f44336;\\n  color: white;\\n}\\n.notifications[_ngcontent-%COMP%]   .notification.error[_ngcontent-%COMP%]   .error-details[_ngcontent-%COMP%] {\\n  margin-top: 8px;\\n  font-size: 14px;\\n  font-weight: normal;\\n  white-space: pre-line;\\n  text-align: left;\\n}\\n\\n.loading-spinner[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: center;\\n  padding: 40px 0;\\n}\\n.loading-spinner[_ngcontent-%COMP%]:after {\\n  content: \\\"\\\";\\n  width: 40px;\\n  height: 40px;\\n  border: 4px solid #f3f3f3;\\n  border-top: 4px solid #a83939;\\n  border-radius: 50%;\\n  animation: _ngcontent-%COMP%_spin 1s linear infinite;\\n}\\n\\n.edit-form-container[_ngcontent-%COMP%] {\\n  background-color: white;\\n  border-radius: 8px;\\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\\n  padding: 20px;\\n}\\n\\n.listing-form[_ngcontent-%COMP%] {\\n  display: flex;\\n  gap: 30px;\\n}\\n@media (max-width: 768px) {\\n  .listing-form[_ngcontent-%COMP%] {\\n    flex-direction: column;\\n  }\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%] {\\n  flex: 1;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  font-size: 16px;\\n  margin-bottom: 15px;\\n  color: #555;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: repeat(2, 1fr);\\n  gap: 15px;\\n  margin-bottom: 15px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%]   .photo-upload[_ngcontent-%COMP%] {\\n  aspect-ratio: 1/1;\\n  border: 1px dashed #ccc;\\n  border-radius: 4px;\\n  overflow: hidden;\\n  position: relative;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%]   .photo-upload[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%]   .photo-upload[_ngcontent-%COMP%]   .upload-placeholder[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: center;\\n  height: 100%;\\n  color: #999;\\n  cursor: pointer;\\n  transition: background-color 0.2s;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%]   .photo-upload[_ngcontent-%COMP%]   .upload-placeholder[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {\\n  margin-bottom: 10px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%]   .photo-upload[_ngcontent-%COMP%]   .upload-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  font-size: 14px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-grid[_ngcontent-%COMP%]   .photo-upload[_ngcontent-%COMP%]   .upload-placeholder[_ngcontent-%COMP%]:hover {\\n  background-color: #f9f9f9;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-options[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  color: #555;\\n  font-size: 14px;\\n  cursor: pointer;\\n}\\n.listing-form[_ngcontent-%COMP%]   .photos-container[_ngcontent-%COMP%]   .photo-options[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\n  margin-right: 8px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%] {\\n  flex: 1;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%] {\\n  margin-bottom: 20px;\\n  \\n\\n  \\n\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\\n  display: block;\\n  margin-bottom: 8px;\\n  font-weight: 500;\\n  color: #555;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%] {\\n  width: 100%;\\n  padding: 10px 12px;\\n  border: 1px solid #ddd;\\n  border-radius: 4px;\\n  font-size: 16px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus {\\n  outline: none;\\n  border-color: #a83939;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%] {\\n  border-color: #f44336;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%] {\\n  resize: vertical;\\n  min-height: 100px;\\n  line-height: 1.5;\\n  font-family: inherit;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .character-counter[_ngcontent-%COMP%] {\\n  text-align: right;\\n  font-size: 13px;\\n  color: #777;\\n  margin-top: 5px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%], .listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%] {\\n  color: #f44336;\\n  font-size: 14px;\\n  margin-top: 5px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .photo-options[_ngcontent-%COMP%] {\\n  margin-bottom: 20px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%] {\\n  display: flex;\\n  gap: 15px;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\\n  flex: 1;\\n  padding: 12px;\\n  border: none;\\n  border-radius: 4px;\\n  font-size: 16px;\\n  cursor: pointer;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%] {\\n  background-color: #a83939;\\n  color: white;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled) {\\n  background-color: #822c2c;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:disabled {\\n  background-color: #ccc;\\n  cursor: not-allowed;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%] {\\n  background-color: #f5f5f5;\\n  color: #333;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover {\\n  background-color: #e0e0e0;\\n}\\n.listing-form[_ngcontent-%COMP%]   .form-details[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   .spinner-border-sm[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  width: 1rem;\\n  height: 1rem;\\n  border: 0.2em solid currentColor;\\n  border-right-color: transparent;\\n  border-radius: 50%;\\n  animation: _ngcontent-%COMP%_spinner-border 0.75s linear infinite;\\n  margin-right: 8px;\\n}\\n\\n.not-found[_ngcontent-%COMP%] {\\n  text-align: center;\\n  padding: 60px 0;\\n}\\n.not-found[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  font-size: 24px;\\n  margin-bottom: 15px;\\n  color: #333;\\n}\\n.not-found[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  margin-bottom: 20px;\\n  color: #666;\\n}\\n.not-found[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  padding: 10px 20px;\\n  background-color: #a83939;\\n  color: white;\\n  text-decoration: none;\\n  border-radius: 4px;\\n}\\n.not-found[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover {\\n  background-color: #822c2c;\\n}\\n\\n@keyframes _ngcontent-%COMP%_spin {\\n  0% {\\n    transform: rotate(0deg);\\n  }\\n  100% {\\n    transform: rotate(360deg);\\n  }\\n}\\n@keyframes _ngcontent-%COMP%_spinner-border {\\n  to {\\n    transform: rotate(360deg);\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9lZGl0LWxpc3RpbmcvZWRpdC1saXN0aW5nLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGdFQUFBO0FBQ0E7RUFDRSxpQkFBQTtFQUNBLGNBQUE7RUFDQSxrQkFBQTtBQUNGOztBQUVBO0VBQ0UsZUFBQTtFQUNBLG1CQUFBO0VBQ0EsV0FBQTtBQUNGOztBQUVBO0VBQ0UsbUJBQUE7QUFDRjtBQUNFO0VBQ0Usa0JBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQUNKO0FBQ0k7RUFDRSx5QkFBQTtFQUNBLFlBQUE7QUFDTjtBQUVJO0VBQ0UseUJBQUE7RUFDQSxZQUFBO0FBQU47QUFFTTtFQUNFLGVBQUE7RUFDQSxlQUFBO0VBQ0EsbUJBQUE7RUFDQSxxQkFBQTtFQUNBLGdCQUFBO0FBQVI7O0FBTUE7RUFDRSxhQUFBO0VBQ0EsdUJBQUE7RUFDQSxlQUFBO0FBSEY7QUFLRTtFQUNFLFdBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtFQUNBLHlCQUFBO0VBQ0EsNkJBQUE7RUFDQSxrQkFBQTtFQUNBLGtDQUFBO0FBSEo7O0FBT0E7RUFDRSx1QkFBQTtFQUNBLGtCQUFBO0VBQ0EseUNBQUE7RUFDQSxhQUFBO0FBSkY7O0FBT0E7RUFDRSxhQUFBO0VBQ0EsU0FBQTtBQUpGO0FBTUU7RUFKRjtJQUtJLHNCQUFBO0VBSEY7QUFDRjtBQUtFO0VBQ0UsT0FBQTtBQUhKO0FBS0k7RUFDRSxlQUFBO0VBQ0EsbUJBQUE7RUFDQSxXQUFBO0FBSE47QUFNSTtFQUNFLGFBQUE7RUFDQSxxQ0FBQTtFQUNBLFNBQUE7RUFDQSxtQkFBQTtBQUpOO0FBTU07RUFDRSxpQkFBQTtFQUNBLHVCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtFQUNBLGtCQUFBO0FBSlI7QUFNUTtFQUNFLFdBQUE7RUFDQSxZQUFBO0VBQ0EsaUJBQUE7QUFKVjtBQU9RO0VBQ0UsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLFlBQUE7RUFDQSxXQUFBO0VBQ0EsZUFBQTtFQUNBLGlDQUFBO0FBTFY7QUFPVTtFQUNFLG1CQUFBO0FBTFo7QUFRVTtFQUNFLGVBQUE7QUFOWjtBQVNVO0VBQ0UseUJBQUE7QUFQWjtBQWNNO0VBQ0UsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsV0FBQTtFQUNBLGVBQUE7RUFDQSxlQUFBO0FBWlI7QUFjUTtFQUNFLGlCQUFBO0FBWlY7QUFrQkU7RUFDRSxPQUFBO0FBaEJKO0FBa0JJO0VBQ0UsbUJBQUE7RUF5QkEsNENBQUE7RUFPQSw4QkFBQTtBQTlDTjtBQWdCTTtFQUNFLGNBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0VBQ0EsV0FBQTtBQWRSO0FBaUJNO0VBQ0UsV0FBQTtFQUNBLGtCQUFBO0VBQ0Esc0JBQUE7RUFDQSxrQkFBQTtFQUNBLGVBQUE7QUFmUjtBQWlCUTtFQUNFLGFBQUE7RUFDQSxxQkFBQTtBQWZWO0FBa0JRO0VBQ0UscUJBQUE7QUFoQlY7QUFvQk07RUFDRSxnQkFBQTtFQUNBLGlCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxvQkFBQTtBQWxCUjtBQXFCTTtFQUNFLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLFdBQUE7RUFDQSxlQUFBO0FBbkJSO0FBc0JNO0VBQ0UsY0FBQTtFQUNBLGVBQUE7RUFDQSxlQUFBO0FBcEJSO0FBd0JJO0VBQ0UsbUJBQUE7QUF0Qk47QUF5Qkk7RUFDRSxhQUFBO0VBQ0EsU0FBQTtBQXZCTjtBQXlCTTtFQUNFLE9BQUE7RUFDQSxhQUFBO0VBQ0EsWUFBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtFQUNBLGVBQUE7QUF2QlI7QUF5QlE7RUFDRSx5QkFBQTtFQUNBLFlBQUE7QUF2QlY7QUF5QlU7RUFDRSx5QkFBQTtBQXZCWjtBQTBCVTtFQUNFLHNCQUFBO0VBQ0EsbUJBQUE7QUF4Qlo7QUE0QlE7RUFDRSx5QkFBQTtFQUNBLFdBQUE7QUExQlY7QUE0QlU7RUFDRSx5QkFBQTtBQTFCWjtBQThCUTtFQUNFLHFCQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxnQ0FBQTtFQUNBLCtCQUFBO0VBQ0Esa0JBQUE7RUFDQSwrQ0FBQTtFQUNBLGlCQUFBO0FBNUJWOztBQW1DQTtFQUNFLGtCQUFBO0VBQ0EsZUFBQTtBQWhDRjtBQWtDRTtFQUNFLGVBQUE7RUFDQSxtQkFBQTtFQUNBLFdBQUE7QUFoQ0o7QUFtQ0U7RUFDRSxtQkFBQTtFQUNBLFdBQUE7QUFqQ0o7QUFvQ0U7RUFDRSxxQkFBQTtFQUNBLGtCQUFBO0VBQ0EseUJBQUE7RUFDQSxZQUFBO0VBQ0EscUJBQUE7RUFDQSxrQkFBQTtBQWxDSjtBQW9DSTtFQUNFLHlCQUFBO0FBbENOOztBQXVDQTtFQUNFO0lBQ0UsdUJBQUE7RUFwQ0Y7RUF1Q0E7SUFDRSx5QkFBQTtFQXJDRjtBQUNGO0FBd0NBO0VBQ0U7SUFDRSx5QkFBQTtFQXRDRjtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLyogc3JjL2FwcC9jb21wb25lbnRzL2VkaXQtbGlzdGluZy9lZGl0LWxpc3RpbmcuY29tcG9uZW50LnNjc3MgKi9cclxuLmNvbnRhaW5lciB7XHJcbiAgbWF4LXdpZHRoOiAxMDAwcHg7XHJcbiAgbWFyZ2luOiAwIGF1dG87XHJcbiAgcGFkZGluZzogNDBweCAyMHB4O1xyXG59XHJcblxyXG5oMSB7XHJcbiAgZm9udC1zaXplOiAyOHB4O1xyXG4gIG1hcmdpbi1ib3R0b206IDMwcHg7XHJcbiAgY29sb3I6ICMzMzM7XHJcbn1cclxuXHJcbi5ub3RpZmljYXRpb25zIHtcclxuICBtYXJnaW4tYm90dG9tOiAyMHB4O1xyXG5cclxuICAubm90aWZpY2F0aW9uIHtcclxuICAgIHBhZGRpbmc6IDEycHggMTZweDtcclxuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XHJcbiAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBmb250LXdlaWdodDogNTAwO1xyXG5cclxuICAgICYuc3VjY2VzcyB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0Y2FmNTA7XHJcbiAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuXHJcbiAgICAmLmVycm9yIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y0NDMzNjtcclxuICAgICAgY29sb3I6IHdoaXRlO1xyXG5cclxuICAgICAgLmVycm9yLWRldGFpbHMge1xyXG4gICAgICAgIG1hcmdpbi10b3A6IDhweDtcclxuICAgICAgICBmb250LXNpemU6IDE0cHg7XHJcbiAgICAgICAgZm9udC13ZWlnaHQ6IG5vcm1hbDtcclxuICAgICAgICB3aGl0ZS1zcGFjZTogcHJlLWxpbmU7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLmxvYWRpbmctc3Bpbm5lciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICBwYWRkaW5nOiA0MHB4IDA7XHJcblxyXG4gICY6YWZ0ZXIge1xyXG4gICAgY29udGVudDogJyc7XHJcbiAgICB3aWR0aDogNDBweDtcclxuICAgIGhlaWdodDogNDBweDtcclxuICAgIGJvcmRlcjogNHB4IHNvbGlkICNmM2YzZjM7XHJcbiAgICBib3JkZXItdG9wOiA0cHggc29saWQgI2E4MzkzOTtcclxuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgIGFuaW1hdGlvbjogc3BpbiAxcyBsaW5lYXIgaW5maW5pdGU7XHJcbiAgfVxyXG59XHJcblxyXG4uZWRpdC1mb3JtLWNvbnRhaW5lciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XHJcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xyXG4gIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG4gIHBhZGRpbmc6IDIwcHg7XHJcbn1cclxuXHJcbi5saXN0aW5nLWZvcm0ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZ2FwOiAzMHB4O1xyXG5cclxuICBAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgfVxyXG5cclxuICAucGhvdG9zLWNvbnRhaW5lciB7XHJcbiAgICBmbGV4OiAxO1xyXG5cclxuICAgIGgzIHtcclxuICAgICAgZm9udC1zaXplOiAxNnB4O1xyXG4gICAgICBtYXJnaW4tYm90dG9tOiAxNXB4O1xyXG4gICAgICBjb2xvcjogIzU1NTtcclxuICAgIH1cclxuXHJcbiAgICAucGhvdG8tZ3JpZCB7XHJcbiAgICAgIGRpc3BsYXk6IGdyaWQ7XHJcbiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDIsIDFmcik7XHJcbiAgICAgIGdhcDogMTVweDtcclxuICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDtcclxuXHJcbiAgICAgIC5waG90by11cGxvYWQge1xyXG4gICAgICAgIGFzcGVjdC1yYXRpbzogMSAvIDE7XHJcbiAgICAgICAgYm9yZGVyOiAxcHggZGFzaGVkICNjY2M7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gICAgICAgIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG5cclxuICAgICAgICBpbWcge1xyXG4gICAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICAgICAgICBvYmplY3QtZml0OiBjb3ZlcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC51cGxvYWQtcGxhY2Vob2xkZXIge1xyXG4gICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICAgICAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICAgICAgICBjb2xvcjogIzk5OTtcclxuICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcclxuXHJcbiAgICAgICAgICBzdmcge1xyXG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHNwYW4ge1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDE0cHg7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgJjpob3ZlciB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLnBob3RvLW9wdGlvbnMge1xyXG4gICAgICAuY2hlY2tib3gtbGFiZWwge1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgICAgICBjb2xvcjogIzU1NTtcclxuICAgICAgICBmb250LXNpemU6IDE0cHg7XHJcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG5cclxuICAgICAgICBpbnB1dCB7XHJcbiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDhweDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC5mb3JtLWRldGFpbHMge1xyXG4gICAgZmxleDogMTtcclxuXHJcbiAgICAuZm9ybS1ncm91cCB7XHJcbiAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XHJcblxyXG4gICAgICBsYWJlbCB7XHJcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICAgICAgbWFyZ2luLWJvdHRvbTogOHB4O1xyXG4gICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgICAgICAgY29sb3I6ICM1NTU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC5mb3JtLWNvbnRyb2wge1xyXG4gICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgIHBhZGRpbmc6IDEwcHggMTJweDtcclxuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZGRkO1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgICBmb250LXNpemU6IDE2cHg7XHJcblxyXG4gICAgICAgICY6Zm9jdXMge1xyXG4gICAgICAgICAgb3V0bGluZTogbm9uZTtcclxuICAgICAgICAgIGJvcmRlci1jb2xvcjogI2E4MzkzOTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICYuaXMtaW52YWxpZCB7XHJcbiAgICAgICAgICBib3JkZXItY29sb3I6ICNmNDQzMzY7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8qIFN0eWxlcyBmb3IgdGV4dGFyZWEgKGRlc2NyaXB0aW9uIGZpZWxkKSAqL1xyXG4gICAgICB0ZXh0YXJlYS5mb3JtLWNvbnRyb2wge1xyXG4gICAgICAgIHJlc2l6ZTogdmVydGljYWw7XHJcbiAgICAgICAgbWluLWhlaWdodDogMTAwcHg7XHJcbiAgICAgICAgbGluZS1oZWlnaHQ6IDEuNTtcclxuICAgICAgICBmb250LWZhbWlseTogaW5oZXJpdDtcclxuICAgICAgfVxyXG4gICAgICAvKiBDaGFyYWN0ZXIgY291bnRlciBzdHlsaW5nICovXHJcbiAgICAgIC5jaGFyYWN0ZXItY291bnRlciB7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7XHJcbiAgICAgICAgZm9udC1zaXplOiAxM3B4O1xyXG4gICAgICAgIGNvbG9yOiAjNzc3O1xyXG4gICAgICAgIG1hcmdpbi10b3A6IDVweDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLmludmFsaWQtZmVlZGJhY2ssIC5lcnJvci1tZXNzYWdlIHtcclxuICAgICAgICBjb2xvcjogI2Y0NDMzNjtcclxuICAgICAgICBmb250LXNpemU6IDE0cHg7XHJcbiAgICAgICAgbWFyZ2luLXRvcDogNXB4O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLnBob3RvLW9wdGlvbnMge1xyXG4gICAgICBtYXJnaW4tYm90dG9tOiAyMHB4O1xyXG4gICAgfVxyXG5cclxuICAgIC5mb3JtLWFjdGlvbnMge1xyXG4gICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICBnYXA6IDE1cHg7XHJcblxyXG4gICAgICAuYnRuIHtcclxuICAgICAgICBmbGV4OiAxO1xyXG4gICAgICAgIHBhZGRpbmc6IDEycHg7XHJcbiAgICAgICAgYm9yZGVyOiBub25lO1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG5cclxuICAgICAgICAmLmJ0bi1wcmltYXJ5IHtcclxuICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNhODM5Mzk7XHJcbiAgICAgICAgICBjb2xvcjogd2hpdGU7XHJcblxyXG4gICAgICAgICAgJjpob3Zlcjpub3QoOmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IGRhcmtlbigjYTgzOTM5LCAxMCUpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICY6ZGlzYWJsZWQge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjY2NjO1xyXG4gICAgICAgICAgICBjdXJzb3I6IG5vdC1hbGxvd2VkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJi5idG4tc2Vjb25kYXJ5IHtcclxuICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7XHJcbiAgICAgICAgICBjb2xvcjogIzMzMztcclxuXHJcbiAgICAgICAgICAmOmhvdmVyIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2UwZTBlMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC5zcGlubmVyLWJvcmRlci1zbSB7XHJcbiAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICAgICAgICB3aWR0aDogMXJlbTtcclxuICAgICAgICAgIGhlaWdodDogMXJlbTtcclxuICAgICAgICAgIGJvcmRlcjogMC4yZW0gc29saWQgY3VycmVudENvbG9yO1xyXG4gICAgICAgICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiB0cmFuc3BhcmVudDtcclxuICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgICAgICAgIGFuaW1hdGlvbjogc3Bpbm5lci1ib3JkZXIgLjc1cyBsaW5lYXIgaW5maW5pdGU7XHJcbiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDhweDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi5ub3QtZm91bmQge1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICBwYWRkaW5nOiA2MHB4IDA7XHJcblxyXG4gIGgyIHtcclxuICAgIGZvbnQtc2l6ZTogMjRweDtcclxuICAgIG1hcmdpbi1ib3R0b206IDE1cHg7XHJcbiAgICBjb2xvcjogIzMzMztcclxuICB9XHJcblxyXG4gIHAge1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMjBweDtcclxuICAgIGNvbG9yOiAjNjY2O1xyXG4gIH1cclxuXHJcbiAgLmJ0biB7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICBwYWRkaW5nOiAxMHB4IDIwcHg7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjYTgzOTM5O1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG5cclxuICAgICY6aG92ZXIge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBkYXJrZW4oI2E4MzkzOSwgMTAlKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbkBrZXlmcmFtZXMgc3BpbiB7XHJcbiAgMCUge1xyXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XHJcbiAgfVxyXG5cclxuICAxMDAlIHtcclxuICAgIHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7XHJcbiAgfVxyXG59XHJcblxyXG5Aa2V5ZnJhbWVzIHNwaW5uZXItYm9yZGVyIHtcclxuICB0byB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpO1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["Validators","environment","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","ctx_r5","errorMessage","ɵɵtemplate","EditListingComponent_div_5_div_2_Template","ɵɵproperty","ctx_r1","ɵɵelement","photo_r12","ɵɵsanitizeUrl","ɵɵlistener","EditListingComponent_div_7_div_6_div_2_Template_div_click_0_listener","ɵɵrestoreView","_r19","i_r13","ɵɵnextContext","index","ctx_r17","ɵɵresetView","triggerFileInput","ɵɵnamespaceSVG","ɵɵnamespaceHTML","EditListingComponent_div_7_div_6_img_1_Template","EditListingComponent_div_7_div_6_div_2_Template","EditListingComponent_div_7_div_42_div_1_Template","EditListingComponent_div_7_div_42_div_2_Template","tmp_0_0","ctx_r10","listingForm","get","errors","tmp_1_0","EditListingComponent_div_7_div_6_Template","EditListingComponent_div_7_Template_form_ngSubmit_8_listener","_r23","ctx_r22","onSubmit","EditListingComponent_div_7_div_13_Template","EditListingComponent_div_7_div_18_Template","EditListingComponent_div_7_div_37_Template","EditListingComponent_div_7_div_42_Template","EditListingComponent_div_7_Template_button_click_48_listener","ctx_r24","cancel","EditListingComponent_div_7_span_51_Template","ctx_r3","photos","ɵɵclassProp","tmp_2_0","invalid","touched","tmp_3_0","tmp_4_0","tmp_5_0","ɵɵtextInterpolate1","tmp_6_0","value","length","tmp_7_0","tmp_8_0","tmp_9_0","isSubmitting","EditListingComponent","constructor","fb","route","router","listingService","authService","notificationService","listing","photoFiles","showSuccessNotification","showFailedNotification","isLoading","initForm","group","title","required","measurement","quality","price","min","description","maxLength","deleteExistingPhotos","ngOnInit","params","subscribe","listingId","isNaN","loadListing","navigate","getListingById","next","console","log","userId","getCurrentUserId","show","patchValue","photoUrls","forEach","url","getImageUrl","error","startsWith","baseUrl","apiUrl","split","fileInput","document","createElement","type","accept","onchange","event","onFileSelected","click","file","target","files","reader","FileReader","onload","e","result","readAsDataURL","valid","formData","FormData","formValues","append","toString","undefined","hasNewPhotos","updateListing","response","setTimeout","key","hasOwnProperty","join","message","err","Object","keys","controls","control","markAsTouched","ɵɵdirectiveInject","i1","FormBuilder","i2","ActivatedRoute","Router","i3","ListingService","i4","AuthService","i5","NotificationService","selectors","decls","vars","consts","template","EditListingComponent_Template","rf","ctx","EditListingComponent_div_4_Template","EditListingComponent_div_5_Template","EditListingComponent_div_6_Template","EditListingComponent_div_7_Template","EditListingComponent_div_8_Template"],"sources":["C:\\Users\\leust\\source\\repos\\MPP-main\\Thrifto\\thrifto.client\\src\\app\\components\\edit-listing\\edit-listing.component.ts","C:\\Users\\leust\\source\\repos\\MPP-main\\Thrifto\\thrifto.client\\src\\app\\components\\edit-listing\\edit-listing.component.html"],"sourcesContent":["// src/app/components/edit-listing/edit-listing.component.ts\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ListingService } from '../../services/listing.service';\r\nimport { AuthService } from '../../services/auth.service';\r\nimport { NotificationService } from '../../services/notification.service';\r\nimport { Listing } from '../../models/listing.model';\r\nimport { environment } from '../../../environments/environment';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\n\r\n@Component({\r\n  selector: 'app-edit-listing',\r\n  templateUrl: './edit-listing.component.html',\r\n  styleUrls: ['./edit-listing.component.scss']\r\n})\r\nexport class EditListingComponent implements OnInit {\r\n  listingId!: number;\r\n  listing: Listing | null = null;\r\n  listingForm!: FormGroup;\r\n  photos: (string | null)[] = [null, null, null, null]; // Four photo placeholders\r\n  photoFiles: (File | null)[] = [null, null, null, null]; // Store the actual file objects\r\n  showSuccessNotification = false;\r\n  showFailedNotification = false;\r\n  isSubmitting = false;\r\n  isLoading = true;\r\n  errorMessage: string = '';\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private listingService: ListingService,\r\n    private authService: AuthService,\r\n    private notificationService: NotificationService\r\n  ) {\r\n    // Initialize the form here\r\n    this.initForm();\r\n  }\r\n\r\n  // Initialize form separately to avoid null issues\r\n  initForm(): void {\r\n    this.listingForm = this.fb.group({\r\n      title: ['', Validators.required],\r\n      measurement: ['', Validators.required],\r\n      quality: ['NEW', Validators.required],\r\n      price: ['', [Validators.required, Validators.min(0.01)]],\r\n      description: ['', [Validators.maxLength(250)]], // Added description field with validation\r\n      deleteExistingPhotos: [false]\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.route.params.subscribe(params => {\r\n      this.listingId = +params['id'];\r\n      if (!isNaN(this.listingId)) {\r\n        this.loadListing();\r\n      } else {\r\n        this.router.navigate(['/sell']);\r\n      }\r\n    });\r\n  }\r\n\r\n  loadListing(): void {\r\n    this.isLoading = true;\r\n\r\n    this.listingService.getListingById(this.listingId).subscribe({\r\n      next: (listing) => {\r\n        this.listing = listing;\r\n        console.log('Loaded listing for editing:', listing);\r\n\r\n        // Check if the current user is the owner\r\n        if (listing.userId !== this.authService.getCurrentUserId()) {\r\n          this.notificationService.show('You do not have permission to edit this listing', 'error');\r\n          this.router.navigate(['/sell']);\r\n          return;\r\n        }\r\n\r\n        // Populate the form with safer null checks\r\n        this.listingForm.patchValue({\r\n          title: listing.title || '',\r\n          measurement: listing.measurement || '',\r\n          quality: listing.quality || 'NEW',\r\n          price: listing.price || '',\r\n          description: listing.description || '' // Make sure description is initialized\r\n        });\r\n\r\n        console.log('Form values after patch:', this.listingForm.value);\r\n\r\n        // Populate photo previews\r\n        if (listing.photoUrls?.length) {\r\n          listing.photoUrls.forEach((url, index) => {\r\n            if (index < 4) {\r\n              this.photos[index] = this.getImageUrl(url);\r\n            }\r\n          });\r\n        }\r\n\r\n        this.isLoading = false;\r\n      },\r\n      error: (error) => {\r\n        console.error('Error loading listing', error);\r\n        this.notificationService.show('Error loading listing details', 'error');\r\n        this.isLoading = false;\r\n        this.router.navigate(['/sell']);\r\n      }\r\n    });\r\n  }\r\n\r\n  getImageUrl(url: string): string {\r\n    if (!url) {\r\n      return 'assets/images/placeholder.png';\r\n    }\r\n\r\n    // If the URL is relative (from your backend)\r\n    if (url.startsWith('/')) {\r\n      const baseUrl = environment.apiUrl.split('/api')[0];\r\n      return `${baseUrl}${url}`;\r\n    }\r\n\r\n    return url;\r\n  }\r\n\r\n  triggerFileInput(index: number): void {\r\n    const fileInput = document.createElement('input');\r\n    fileInput.type = 'file';\r\n    fileInput.accept = 'image/*';\r\n    fileInput.onchange = (event: any) => {\r\n      this.onFileSelected(event, index);\r\n    };\r\n    fileInput.click();\r\n  }\r\n\r\n  onFileSelected(event: any, index: number): void {\r\n    const file = event.target.files[0];\r\n    if (file) {\r\n      this.photoFiles[index] = file;\r\n\r\n      const reader = new FileReader();\r\n      reader.onload = (e: any) => {\r\n        this.photos[index] = e.target.result;\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  }\r\n\r\n  onSubmit(): void {\r\n    if (this.listingForm.valid) {\r\n      this.isSubmitting = true;\r\n      this.errorMessage = '';\r\n\r\n      try {\r\n        const formData = new FormData();\r\n\r\n        // Get all form values from the form\r\n        const formValues = this.listingForm.value;\r\n        console.log('Original form values:', formValues);\r\n\r\n        // Append form values - using lowercase to match model binding\r\n        formData.append('title', formValues.title || '');\r\n        formData.append('measurement', formValues.measurement || '');\r\n        formData.append('quality', formValues.quality || '');\r\n        formData.append('price', (formValues.price || 0).toString());\r\n\r\n        // Handle description field - ensure it's never null\r\n        const description = formValues.description !== null && formValues.description !== undefined\r\n          ? formValues.description\r\n          : '';\r\n        formData.append('description', description);\r\n\r\n        // Handle delete existing photos flag\r\n        formData.append('deleteExistingPhotos', formValues.deleteExistingPhotos ? 'true' : 'false');\r\n\r\n        // Add new photos if any\r\n        let hasNewPhotos = false;\r\n        this.photoFiles.forEach(file => {\r\n          if (file) {\r\n            formData.append('photos', file);\r\n            hasNewPhotos = true;\r\n          }\r\n        });\r\n\r\n        // Debug the form data\r\n        console.log('Submitting update with new photos:', hasNewPhotos);\r\n\r\n        this.listingService.updateListing(this.listingId, formData).subscribe({\r\n          next: (response) => {\r\n            this.isSubmitting = false;\r\n            this.showSuccessNotification = true;\r\n            this.notificationService.show('Listing updated successfully!', 'success');\r\n            setTimeout(() => {\r\n              this.showSuccessNotification = false;\r\n              this.router.navigate(['/listing', this.listingId]);\r\n            }, 2000);\r\n          },\r\n          error: (error: HttpErrorResponse) => {\r\n            this.isSubmitting = false;\r\n            this.showFailedNotification = true;\r\n\r\n            // Attempt to extract a more detailed error message\r\n            if (error.error) {\r\n              if (typeof error.error === 'string') {\r\n                this.errorMessage = error.error;\r\n              } else if (error.error.errors) {\r\n                this.errorMessage = 'Validation errors: ';\r\n                for (const key in error.error.errors) {\r\n                  if (error.error.errors.hasOwnProperty(key)) {\r\n                    this.errorMessage += `${key}: ${error.error.errors[key].join(', ')}; `;\r\n                  }\r\n                }\r\n              } else if (error.error.message) {\r\n                this.errorMessage = error.error.message;\r\n              }\r\n            }\r\n\r\n            console.error('Error updating listing', error);\r\n            this.notificationService.show(`Error updating listing: ${this.errorMessage || 'Unknown error'}`, 'error');\r\n\r\n            setTimeout(() => this.showFailedNotification = false, 3000);\r\n          }\r\n        });\r\n      } catch (err) {\r\n        this.isSubmitting = false;\r\n        this.showFailedNotification = true;\r\n        console.error('Exception while preparing form data:', err);\r\n        this.notificationService.show('Error preparing form data', 'error');\r\n        setTimeout(() => this.showFailedNotification = false, 3000);\r\n      }\r\n    } else {\r\n      // Form is invalid - highlight the errors\r\n      Object.keys(this.listingForm.controls).forEach(key => {\r\n        const control = this.listingForm.get(key);\r\n        if (control?.invalid) {\r\n          control.markAsTouched();\r\n        }\r\n      });\r\n      this.notificationService.show('Please fix the form errors before submitting', 'error');\r\n    }\r\n  }\r\n\r\n  cancel(): void {\r\n    this.router.navigate(['/listing', this.listingId]);\r\n  }\r\n}\r\n","<!-- src/app/components/edit-listing/edit-listing.component.html -->\r\n<div class=\"container\">\r\n  <h1>Edit Listing</h1>\r\n\r\n  <div class=\"notifications\">\r\n    <div *ngIf=\"showSuccessNotification\" class=\"notification success\">\r\n      UPDATED SUCCESSFULLY\r\n    </div>\r\n    <div *ngIf=\"showFailedNotification\" class=\"notification error\">\r\n      UPDATE FAILED\r\n      <div *ngIf=\"errorMessage\" class=\"error-details\">{{ errorMessage }}</div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"loading-spinner\" *ngIf=\"isLoading\"></div>\r\n\r\n  <div class=\"edit-form-container\" *ngIf=\"!isLoading && listing\">\r\n    <div class=\"listing-form\">\r\n      <div class=\"photos-container\">\r\n        <h3>Photos</h3>\r\n        <div class=\"photo-grid\">\r\n          <div class=\"photo-upload\" *ngFor=\"let photo of photos; let i = index\">\r\n            <img *ngIf=\"photo\" [src]=\"photo\" alt=\"Product photo\">\r\n            <div *ngIf=\"!photo\" class=\"upload-placeholder\" (click)=\"triggerFileInput(i)\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n                <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"></path>\r\n                <polyline points=\"14 2 14 8 20 8\"></polyline>\r\n                <line x1=\"12\" y1=\"18\" x2=\"12\" y2=\"12\"></line>\r\n                <line x1=\"9\" y1=\"15\" x2=\"15\" y2=\"15\"></line>\r\n              </svg>\r\n              <span>Add Photo</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"form-details\">\r\n        <form [formGroup]=\"listingForm\" (ngSubmit)=\"onSubmit()\">\r\n          <div class=\"form-group\">\r\n            <label for=\"title\">Title</label>\r\n            <input type=\"text\"\r\n                   id=\"title\"\r\n                   formControlName=\"title\"\r\n                   placeholder=\"e.g., Women's Jeans\"\r\n                   class=\"form-control\"\r\n                   [class.is-invalid]=\"listingForm.get('title')?.invalid && listingForm.get('title')?.touched\">\r\n            <div *ngIf=\"listingForm.get('title')?.invalid && listingForm.get('title')?.touched\" class=\"invalid-feedback\">\r\n              Title is required\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label for=\"measurement\">Measurement</label>\r\n            <input type=\"text\"\r\n                   id=\"measurement\"\r\n                   formControlName=\"measurement\"\r\n                   placeholder=\"e.g., W 32UK\"\r\n                   class=\"form-control\"\r\n                   [class.is-invalid]=\"listingForm.get('measurement')?.invalid && listingForm.get('measurement')?.touched\">\r\n            <div *ngIf=\"listingForm.get('measurement')?.invalid && listingForm.get('measurement')?.touched\" class=\"invalid-feedback\">\r\n              Measurement is required\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label for=\"quality\">Quality</label>\r\n            <select id=\"quality\"\r\n                    formControlName=\"quality\"\r\n                    class=\"form-control\">\r\n              <option value=\"NEW\">NEW</option>\r\n              <option value=\"LIKE NEW\">LIKE NEW</option>\r\n              <option value=\"BARELY WORN\">BARELY WORN</option>\r\n              <option value=\"USED\">USED</option>\r\n            </select>\r\n          </div>\r\n\r\n          <!-- Added Description Field -->\r\n          <div class=\"form-group\">\r\n            <label for=\"description\">Description</label>\r\n            <textarea id=\"description\"\r\n                      formControlName=\"description\"\r\n                      class=\"form-control\"\r\n                      rows=\"4\"\r\n                      maxlength=\"250\"\r\n                      placeholder=\"Describe your item (optional)\"></textarea>\r\n            <div class=\"character-counter\">\r\n              {{ listingForm.get('description')?.value?.length || 0 }}/250 characters\r\n            </div>\r\n            <div *ngIf=\"listingForm.get('description')?.invalid && listingForm.get('description')?.touched\" class=\"error-message\">\r\n              Description is too long (maximum 250 characters).\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-group\">\r\n            <label for=\"price\">Price ($)</label>\r\n            <input type=\"number\"\r\n                   id=\"price\"\r\n                   formControlName=\"price\"\r\n                   placeholder=\"e.g., 27\"\r\n                   class=\"form-control\"\r\n                   [class.is-invalid]=\"listingForm.get('price')?.invalid && listingForm.get('price')?.touched\"\r\n                   step=\"0.01\"\r\n                   min=\"0.01\">\r\n            <div *ngIf=\"listingForm.get('price')?.invalid && listingForm.get('price')?.touched\" class=\"invalid-feedback\">\r\n              <div *ngIf=\"listingForm.get('price')?.errors?.['required']\">Price is required</div>\r\n              <div *ngIf=\"listingForm.get('price')?.errors?.['min']\">Price must be greater than 0</div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Move the checkbox inside the form -->\r\n          <div class=\"photo-options\">\r\n            <label class=\"checkbox-label\">\r\n              <input type=\"checkbox\" formControlName=\"deleteExistingPhotos\">\r\n              Replace all existing photos\r\n            </label>\r\n          </div>\r\n\r\n          <div class=\"form-actions\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" (click)=\"cancel()\">\r\n              Cancel\r\n            </button>\r\n            <button type=\"submit\"\r\n                    class=\"btn btn-primary\"\r\n                    [disabled]=\"listingForm.invalid || isSubmitting\">\r\n              <span *ngIf=\"isSubmitting\" class=\"spinner-border spinner-border-sm\"></span>\r\n              Update Listing\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"not-found\" *ngIf=\"!isLoading && !listing\">\r\n    <h2>Listing Not Found</h2>\r\n    <p>The listing you're trying to edit does not exist or has been removed.</p>\r\n    <a routerLink=\"/sell\" class=\"btn btn-primary\">Go Back to Sell Page</a>\r\n  </div>\r\n</div>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}